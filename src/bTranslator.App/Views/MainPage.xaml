<?xml version="1.0" encoding="UTF-8" ?>
<Page
    x:Class="bTranslator.App.Views.MainPage"
    x:Name="RootPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="using:bTranslator.App.ViewModels"
    mc:Ignorable="d">
    <Page.Resources>
        <Style x:Key="FluentSurfaceBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="{StaticResource VsCodeBorderBrush}" />
            <Setter Property="BorderThickness" Value="0,1,0,0" />
            <Setter Property="CornerRadius" Value="0" />
        </Style>

        <Style x:Key="TopMenuBarStyle" TargetType="MenuBar">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{StaticResource VsCodeTextBrush}" />
            <Setter Property="FontFamily" Value="Segoe UI Variable Text" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="MinHeight" Value="32" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style x:Key="TopMenuBarItemStyle" TargetType="MenuBarItem">
            <Setter Property="Foreground" Value="{StaticResource VsCodeTextBrush}" />
            <Setter Property="FontFamily" Value="Segoe UI Variable Text" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Margin" Value="1,0,1,0" />
        </Style>

        <Style x:Key="TableHeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI Variable Text Semibold" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="Foreground" Value="{StaticResource VsCodeSubtleTextBrush}" />
        </Style>

        <Style x:Key="SquareFlyoutPresenterStyle" TargetType="FlyoutPresenter">
            <Setter Property="CornerRadius" Value="0" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Background" Value="{StaticResource VsCodeBackgroundBrush}" />
        </Style>

        <SolidColorBrush
            x:Key="MainSurfaceBrush"
            Color="#232326" />
        <SolidColorBrush
            x:Key="MainSurfaceAltBrush"
            Color="#1F2023" />
        <SolidColorBrush
            x:Key="MainPanelBorderBrush"
            Color="#3A3D41" />

        <SolidColorBrush
            x:Key="ListViewItemBackground"
            Color="#00000000" />
        <SolidColorBrush
            x:Key="ListViewItemBackgroundPointerOver"
            Color="#2B2D31" />
        <SolidColorBrush
            x:Key="ListViewItemBackgroundPressed"
            Color="#343840" />
        <SolidColorBrush
            x:Key="ListViewItemBackgroundSelected"
            Color="#1E3447" />
        <SolidColorBrush
            x:Key="ListViewItemBackgroundSelectedPointerOver"
            Color="#25425A" />
        <SolidColorBrush
            x:Key="ListViewItemBackgroundSelectedPressed"
            Color="#2A4B66" />
        <SolidColorBrush
            x:Key="ListViewItemForeground"
            Color="#CCCCCC" />
        <SolidColorBrush
            x:Key="ListViewItemForegroundPointerOver"
            Color="#F0F0F0" />
        <SolidColorBrush
            x:Key="ListViewItemForegroundPressed"
            Color="#FFFFFF" />
        <SolidColorBrush
            x:Key="ListViewItemForegroundSelected"
            Color="#FFFFFF" />
        <SolidColorBrush
            x:Key="ListViewItemForegroundSelectedPointerOver"
            Color="#FFFFFF" />
        <SolidColorBrush
            x:Key="ListViewItemForegroundSelectedPressed"
            Color="#FFFFFF" />
        <SolidColorBrush
            x:Key="ListViewItemFocusBorderBrush"
            Color="#0E639C" />
        <SolidColorBrush
            x:Key="ListViewItemFocusSecondaryBorderBrush"
            Color="#1E1E1E" />

        <SolidColorBrush
            x:Key="TextControlBackground"
            Color="#1F2023" />
        <SolidColorBrush
            x:Key="TextControlBackgroundPointerOver"
            Color="#24262A" />
        <SolidColorBrush
            x:Key="TextControlBackgroundFocused"
            Color="#252A30" />
        <SolidColorBrush
            x:Key="TextControlBorderBrush"
            Color="#3A3D41" />
        <SolidColorBrush
            x:Key="TextControlBorderBrushPointerOver"
            Color="#4A4F56" />
        <SolidColorBrush
            x:Key="TextControlBorderBrushFocused"
            Color="#0E639C" />
        <SolidColorBrush
            x:Key="TextControlForeground"
            Color="#CCCCCC" />
        <SolidColorBrush
            x:Key="TextControlForegroundPointerOver"
            Color="#EFEFEF" />
        <SolidColorBrush
            x:Key="TextControlForegroundFocused"
            Color="#FFFFFF" />
        <SolidColorBrush
            x:Key="TextControlPlaceholderForeground"
            Color="#9D9D9D" />
        <SolidColorBrush
            x:Key="TextControlPlaceholderForegroundPointerOver"
            Color="#A9A9A9" />
        <SolidColorBrush
            x:Key="TextControlPlaceholderForegroundFocused"
            Color="#A9A9A9" />
        <SolidColorBrush
            x:Key="TextControlSelectionHighlightColor"
            Color="#80489BD8" />

        <SolidColorBrush
            x:Key="ComboBoxBackground"
            Color="#1F2023" />
        <SolidColorBrush
            x:Key="ComboBoxBackgroundPointerOver"
            Color="#24262A" />
        <SolidColorBrush
            x:Key="ComboBoxBackgroundPressed"
            Color="#2B2F35" />
        <SolidColorBrush
            x:Key="ComboBoxBackgroundFocused"
            Color="#252A30" />
        <SolidColorBrush
            x:Key="ComboBoxBorderBrush"
            Color="#3A3D41" />
        <SolidColorBrush
            x:Key="ComboBoxBorderBrushPointerOver"
            Color="#4A4F56" />
        <SolidColorBrush
            x:Key="ComboBoxBorderBrushPressed"
            Color="#0E639C" />
        <SolidColorBrush
            x:Key="ComboBoxForeground"
            Color="#CCCCCC" />
        <SolidColorBrush
            x:Key="ComboBoxForegroundPointerOver"
            Color="#EFEFEF" />
        <SolidColorBrush
            x:Key="ComboBoxForegroundPressed"
            Color="#FFFFFF" />
        <SolidColorBrush
            x:Key="ComboBoxForegroundFocused"
            Color="#FFFFFF" />
        <SolidColorBrush
            x:Key="ComboBoxForegroundFocusedPressed"
            Color="#FFFFFF" />
        <SolidColorBrush
            x:Key="ComboBoxBackgroundBorderBrushFocused"
            Color="#0E639C" />
        <SolidColorBrush
            x:Key="ComboBoxBackgroundBorderBrushUnfocused"
            Color="#3A3D41" />

        <Style
            x:Key="MainPanelBorderStyle"
            BasedOn="{StaticResource PanelCardBorderStyle}"
            TargetType="Border">
            <Setter Property="Background" Value="{StaticResource MainSurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource MainPanelBorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="10" />
        </Style>

        <Style
            x:Key="MetricPanelBorderStyle"
            BasedOn="{StaticResource MainPanelBorderStyle}"
            TargetType="Border">
            <Setter Property="Padding" Value="12,10" />
        </Style>

        <Style x:Key="InsetPanelBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource MainSurfaceAltBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource MainPanelBorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="0" />
            <Setter Property="Padding" Value="8,6" />
        </Style>

        <Style
            x:Key="DenseHeaderTextStyle"
            BasedOn="{StaticResource TableHeaderTextStyle}"
            TargetType="TextBlock">
            <Setter Property="FontSize" Value="10.5" />
            <Setter Property="CharacterSpacing" Value="20" />
            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
        </Style>

        <Style
            x:Key="InteractiveListItemStyle"
            TargetType="ListViewItem">
            <Setter Property="Padding" Value="0" />
            <Setter Property="Margin" Value="0" />
            <Setter Property="CornerRadius" Value="0" />
            <Setter Property="MinHeight" Value="28" />
            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        </Style>

        <Style
            x:Key="UnifiedInputTextBoxStyle"
            TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource MainSurfaceAltBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource MainPanelBorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="0" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="Foreground" Value="{StaticResource VsCodeTextBrush}" />
        </Style>

        <Style
            x:Key="UnifiedInputComboBoxStyle"
            TargetType="ComboBox">
            <Setter Property="Background" Value="{StaticResource MainSurfaceAltBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource MainPanelBorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="0" />
            <Setter Property="Padding" Value="8,4" />
            <Setter Property="Foreground" Value="{StaticResource VsCodeTextBrush}" />
        </Style>

    </Page.Resources>

    <Grid
        Background="{StaticResource VsCodeBackgroundBrush}"
        Padding="12,0,12,12"
        RowSpacing="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Border
            x:Name="TopTitleBarHost"
            Grid.Row="0"
            Background="{StaticResource VsCodeBackgroundBrush}"
            BorderBrush="{StaticResource VsCodeBorderBrush}"
            BorderThickness="0,0,0,1"
            CornerRadius="0"
            Margin="-12,0,-12,0"
            Padding="14,9,14,10">
            <Grid RowSpacing="6">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <Grid ColumnSpacing="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <FontIcon
                        FontFamily="Segoe Fluent Icons"
                        FontSize="14"
                        Foreground="{StaticResource VsCodeSubtleTextBrush}"
                        Glyph="&#xEA86;"
                        VerticalAlignment="Center" />
                    <StackPanel
                        Grid.Column="1"
                        Orientation="Horizontal"
                        Spacing="8"
                        VerticalAlignment="Center">
                        <TextBlock
                            FontFamily="Segoe UI Variable Display Semibold"
                            FontSize="18"
                            Foreground="{StaticResource VsCodeTextBrush}"
                            Text="{x:Bind ViewModel.Ui.AppWindowTitle, Mode=OneWay}" />
                        <TextBlock
                            FontFamily="Segoe UI Variable Text"
                            Foreground="{StaticResource VsCodeSubtleTextBrush}"
                            Text="{Binding WorkspaceTitle}"
                            VerticalAlignment="Center" />
                    </StackPanel>
                </Grid>

                <Grid
                    Grid.Row="1"
                    ColumnSpacing="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <MenuBar
                        Grid.Column="0"
                        Style="{StaticResource TopMenuBarStyle}">
                        <MenuBarItem
                            Style="{StaticResource TopMenuBarItemStyle}"
                            Title="{x:Bind ViewModel.Ui.MainMenuFileTitle, Mode=OneWay}">
                            <MenuFlyoutItem
                                Click="OnOpenPluginFromMenuClicked"
                                Text="{x:Bind ViewModel.Ui.MenuOpenPlugin, Mode=OneWay}" />
                            <MenuFlyoutItem
                                Command="{Binding SaveWorkspaceCommand}"
                                Text="{x:Bind ViewModel.Ui.MenuSave, Mode=OneWay}" />
                            <MenuFlyoutItem
                                Click="OnOpenAndTranslateFromMenuClicked"
                                Text="{x:Bind ViewModel.Ui.MenuOpenAndAutoTranslate, Mode=OneWay}" />
                            <MenuFlyoutSeparator />
                            <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuPaths, Mode=OneWay}">
                                <MenuFlyoutItem
                                    Click="OnBrowsePluginPathClicked"
                                    Text="{x:Bind ViewModel.Ui.MenuPluginPath, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Click="OnBrowseOutputPathClicked"
                                    Text="{x:Bind ViewModel.Ui.MenuOutputPath, Mode=OneWay}" />
                                <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuOptional, Mode=OneWay}">
                                    <MenuFlyoutItem
                                        Click="OnBrowseStringsDirectoryClicked"
                                        Text="{x:Bind ViewModel.Ui.MenuStringsDirectory, Mode=OneWay}" />
                                    <MenuFlyoutItem
                                        Click="OnBrowseRecordDefinitionsPathClicked"
                                        Text="{x:Bind ViewModel.Ui.MenuRecordDefsPath, Mode=OneWay}" />
                                </MenuFlyoutSubItem>
                            </MenuFlyoutSubItem>
                        </MenuBarItem>

                        <MenuBarItem
                            Style="{StaticResource TopMenuBarItemStyle}"
                            Title="{x:Bind ViewModel.Ui.MainMenuTranslateTitle, Mode=OneWay}">
                            <MenuFlyoutItem
                                Command="{Binding RunBatchTranslationCommand}"
                                Text="{x:Bind ViewModel.Ui.MenuRunBatchTranslation, Mode=OneWay}" />
                            <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuScope, Mode=OneWay}">
                                <ToggleMenuFlyoutItem
                                    IsChecked="{Binding LoadStrings, Mode=TwoWay}"
                                    Text="{x:Bind ViewModel.Ui.MenuLoadStrings, Mode=OneWay}" />
                                <ToggleMenuFlyoutItem
                                    IsChecked="{Binding LoadRecordFields, Mode=TwoWay}"
                                    Text="{x:Bind ViewModel.Ui.MenuLoadRecordFields, Mode=OneWay}" />
                                <ToggleMenuFlyoutItem
                                    IsChecked="{Binding ShowUntranslatedOnly, Mode=TwoWay}"
                                    Text="{x:Bind ViewModel.Ui.MenuOnlyPendingRows, Mode=OneWay}" />
                                <ToggleMenuFlyoutItem
                                    IsChecked="{Binding ShowLocked, Mode=TwoWay}"
                                    Text="{x:Bind ViewModel.Ui.MenuIncludeLockedRows, Mode=OneWay}" />
                            </MenuFlyoutSubItem>
                            <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuSelection, Mode=OneWay}">
                                <MenuFlyoutItem
                                    Command="{Binding CopySourceToTargetCommand}"
                                    Text="{x:Bind ViewModel.Ui.MenuCopySourceToTranslation, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Command="{Binding ApplyInspectorToRowCommand}"
                                    Text="{x:Bind ViewModel.Ui.MenuApplyInspectorEdit, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Command="{Binding MarkSelectedValidatedCommand}"
                                    Text="{x:Bind ViewModel.Ui.MenuMarkSelectedValidated, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Command="{Binding ToggleSelectedLockCommand}"
                                    Text="{x:Bind ViewModel.Ui.MenuToggleLock, Mode=OneWay}" />
                            </MenuFlyoutSubItem>
                        </MenuBarItem>

                        <MenuBarItem
                            Style="{StaticResource TopMenuBarItemStyle}"
                            Title="{x:Bind ViewModel.Ui.MainMenuProvidersTitle, Mode=OneWay}">
                            <MenuFlyoutItem
                                Command="{Binding RefreshCommand}"
                                Text="{x:Bind ViewModel.Ui.MenuReloadMetadata, Mode=OneWay}" />
                            <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuChain, Mode=OneWay}">
                                <MenuFlyoutItem
                                    IsEnabled="False"
                                    Text="{Binding ProviderChainPreview}" />
                            </MenuFlyoutSubItem>
                            <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuConfiguration, Mode=OneWay}">
                                <MenuFlyoutItem
                                    Click="OnOpenAiProviderSetupPageClicked"
                                    Text="{x:Bind ViewModel.Ui.MenuOpenAiProviderSetupWindow, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Click="OnOpenProviderConfigurationPageClicked"
                                    Text="{x:Bind ViewModel.Ui.MenuOpenConfigurationWindow, Mode=OneWay}" />
                                <MenuFlyoutSeparator />
                                <MenuFlyoutItem
                                    Command="{Binding SaveSelectedProviderConfigurationCommand}"
                                    Text="{x:Bind ViewModel.Ui.MenuSaveSelectedProvider, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Command="{Binding ReloadSelectedProviderConfigurationCommand}"
                                    Text="{x:Bind ViewModel.Ui.MenuReloadSelectedProvider, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Command="{Binding TestSelectedProviderConnectionCommand}"
                                    Text="{x:Bind ViewModel.Ui.MenuTestSelectedProvider, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Click="OnImportLegacyApiTranslatorConfigClicked"
                                    Text="{x:Bind ViewModel.Ui.MenuImportApiTranslator, Mode=OneWay}" />
                            </MenuFlyoutSubItem>
                        </MenuBarItem>

                        <MenuBarItem
                            Style="{StaticResource TopMenuBarItemStyle}"
                            Title="{x:Bind ViewModel.Ui.MainMenuViewTitle, Mode=OneWay}">
                            <MenuFlyoutItem
                                Command="{Binding RefreshCommand}"
                                Text="{x:Bind ViewModel.Ui.MenuRefreshWorkspace, Mode=OneWay}" />
                            <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuFilter, Mode=OneWay}">
                                <ToggleMenuFlyoutItem
                                    IsChecked="{Binding ShowUntranslatedOnly, Mode=TwoWay}"
                                    Text="{x:Bind ViewModel.Ui.MenuOnlyPendingRows, Mode=OneWay}" />
                                <ToggleMenuFlyoutItem
                                    IsChecked="{Binding ShowLocked, Mode=TwoWay}"
                                    Text="{x:Bind ViewModel.Ui.MenuShowLockedRows, Mode=OneWay}" />
                            </MenuFlyoutSubItem>
                            <MenuFlyoutSubItem
                                x:Name="ViewThemeMenu"
                                Text="{x:Bind ViewModel.Ui.MenuTheme, Mode=OneWay}" />
                        </MenuBarItem>

                        <MenuBarItem
                            Style="{StaticResource TopMenuBarItemStyle}"
                            Title="{x:Bind ViewModel.Ui.MainMenuWorkspaceTitle, Mode=OneWay}">
                            <MenuFlyoutSubItem
                                x:Name="WorkspaceUiLanguageMenu"
                                Text="{x:Bind ViewModel.Ui.WorkspaceMenuUiLanguageText, Mode=OneWay}" />
                            <MenuFlyoutSubItem
                                x:Name="WorkspaceGameMenu"
                                Text="{x:Bind ViewModel.Ui.WorkspaceMenuGameText, Mode=OneWay}" />
                            <MenuFlyoutSubItem
                                x:Name="WorkspaceSourceLanguageMenu"
                                Text="{x:Bind ViewModel.Ui.WorkspaceMenuSourceLanguageText, Mode=OneWay}" />
                            <MenuFlyoutSubItem
                                x:Name="WorkspaceTargetLanguageMenu"
                                Text="{x:Bind ViewModel.Ui.WorkspaceMenuTargetLanguageText, Mode=OneWay}" />
                            <MenuFlyoutSubItem
                                x:Name="WorkspaceEncodingModeMenu"
                                Text="{x:Bind ViewModel.Ui.WorkspaceMenuEncodingModeText, Mode=OneWay}" />
                            <MenuFlyoutSubItem
                                x:Name="WorkspaceEncodingMenu"
                                Text="{x:Bind ViewModel.Ui.WorkspaceMenuEncodingManualText, Mode=OneWay}" />
                            <MenuFlyoutItem
                                Command="{Binding OpenWorkspaceCommand}"
                                Text="{x:Bind ViewModel.Ui.WorkspaceMenuApplyEncodingText, Mode=OneWay}" />
                            <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuDictionary, Mode=OneWay}">
                                <MenuFlyoutItem
                                    Click="OnEditDictionaryClicked"
                                    Text="{x:Bind ViewModel.Ui.MenuEditDictionary, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Command="{Binding AddScopedDictionaryEntryFromSelectedRowCommand}"
                                    Text="{x:Bind ViewModel.Ui.MenuAddSelectedRowToDictionary, Mode=OneWay}" />
                                <MenuFlyoutSeparator />
                                <MenuFlyoutItem
                                    Click="OnImportDictionaryClicked"
                                    Text="{x:Bind ViewModel.Ui.MenuImportDictionary, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Click="OnExportDictionaryClicked"
                                    Text="{x:Bind ViewModel.Ui.MenuExportDictionary, Mode=OneWay}" />
                                <ToggleMenuFlyoutItem
                                    IsChecked="{Binding IsDictionaryPreReplaceEnabled, Mode=TwoWay}"
                                    Text="{x:Bind ViewModel.Ui.MenuEnableDictionaryPreReplace, Mode=OneWay}" />
                            </MenuFlyoutSubItem>
                            <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuEspCompare, Mode=OneWay}">
                                <MenuFlyoutItem
                                    Click="OnCompareEspClicked"
                                    Text="{x:Bind ViewModel.Ui.MenuCompareWithEsp, Mode=OneWay}" />
                                <MenuFlyoutItem
                                    Command="{Binding ApplyEspCompareReplacementsCommand}"
                                    Text="{x:Bind ViewModel.Ui.MenuApplyEspCompareReplacements, Mode=OneWay}" />
                            </MenuFlyoutSubItem>
                            <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuCompatibilityModes, Mode=OneWay}">
                                <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuCompatibilityPexMode, Mode=OneWay}">
                                    <MenuFlyoutItem
                                        Click="OnOpenPexModeClicked"
                                        Text="{x:Bind ViewModel.Ui.MenuOpenPexMode, Mode=OneWay}" />
                                    <MenuFlyoutItem
                                        Click="OnExportPexStringsClicked"
                                        Text="{x:Bind ViewModel.Ui.MenuExportPexStrings, Mode=OneWay}" />
                                </MenuFlyoutSubItem>
                                <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuCompatibilityMcmMode, Mode=OneWay}">
                                    <MenuFlyoutItem
                                        Click="OnOpenMcmModeClicked"
                                        Text="{x:Bind ViewModel.Ui.MenuOpenMcmMode, Mode=OneWay}" />
                                    <MenuFlyoutItem
                                        Click="OnExportMcmModeClicked"
                                        Text="{x:Bind ViewModel.Ui.MenuExportMcmMode, Mode=OneWay}" />
                                </MenuFlyoutSubItem>
                                <MenuFlyoutSubItem Text="{x:Bind ViewModel.Ui.MenuCompatibilityTxtMode, Mode=OneWay}">
                                    <MenuFlyoutItem
                                        Click="OnOpenTxtModeClicked"
                                        Text="{x:Bind ViewModel.Ui.MenuOpenTxtMode, Mode=OneWay}" />
                                    <MenuFlyoutItem
                                        Click="OnExportTxtModeClicked"
                                        Text="{x:Bind ViewModel.Ui.MenuExportTxtMode, Mode=OneWay}" />
                                    <MenuFlyoutSeparator />
                                    <MenuFlyoutItem
                                        Click="OnRunTxtBatchScriptClicked"
                                        Text="{x:Bind ViewModel.Ui.MenuRunTxtBatchScript, Mode=OneWay}" />
                                </MenuFlyoutSubItem>
                            </MenuFlyoutSubItem>
                            <ToggleMenuFlyoutItem
                                IsChecked="{Binding LoadStrings, Mode=TwoWay}"
                                Text="{x:Bind ViewModel.Ui.MenuLoadStrings, Mode=OneWay}" />
                            <ToggleMenuFlyoutItem
                                IsChecked="{Binding LoadRecordFields, Mode=TwoWay}"
                                Text="{x:Bind ViewModel.Ui.MenuLoadRecordFields, Mode=OneWay}" />
                        </MenuBarItem>
                    </MenuBar>

                    <DropDownButton
                        Grid.Column="1"
                        CornerRadius="0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Top">
                        <DropDownButton.Content>
                            <StackPanel
                                Orientation="Horizontal"
                                Spacing="6">
                                <FontIcon
                                    FontFamily="Segoe Fluent Icons"
                                    Glyph="&#xE8B7;" />
                                <TextBlock
                                    MaxWidth="220"
                                    Text="{Binding ActivePluginName}"
                                    TextTrimming="CharacterEllipsis" />
                            </StackPanel>
                        </DropDownButton.Content>
                        <DropDownButton.Flyout>
                            <Flyout
                                FlyoutPresenterStyle="{StaticResource SquareFlyoutPresenterStyle}"
                                Placement="BottomEdgeAlignedRight">
                                <Border
                                    MaxWidth="460"
                                    MinWidth="340"
                                    Background="{StaticResource VsCodeBackgroundBrush}"
                                    BorderBrush="{StaticResource VsCodeBorderBrush}"
                                    BorderThickness="0,1,0,0"
                                    CornerRadius="0"
                                    Padding="10">
                                    <StackPanel Spacing="8">
                                        <TextBlock
                                            Style="{StaticResource SectionTitleTextStyle}"
                                            Text="{x:Bind ViewModel.Ui.PluginSwitcherTitleText, Mode=OneWay}" />
                                        <TextBox
                                            Style="{StaticResource UnifiedInputTextBoxStyle}"
                                            PlaceholderText="{x:Bind ViewModel.Ui.PluginSwitcherSearchPlaceholder, Mode=OneWay}"
                                            Text="{Binding PluginSwitcherSearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <ListView
                                            ItemContainerStyle="{StaticResource InteractiveListItemStyle}"
                                            IsItemClickEnabled="True"
                                            ItemClick="OnPluginSwitcherItemClick"
                                            ItemsSource="{Binding FilteredPluginSwitcherItems}"
                                            MaxHeight="280"
                                            SelectedItem="{Binding SelectedPluginSwitcherItem, Mode=TwoWay}"
                                            SelectionMode="Single">
                                            <ListView.ItemTemplate>
                                                <DataTemplate x:DataType="viewModels:PluginSwitcherItemViewModel">
                                                    <Border
                                                        Background="Transparent"
                                                        BorderBrush="{StaticResource VsCodeBorderBrush}"
                                                        BorderThickness="0,0,0,1"
                                                        CornerRadius="0"
                                                        Margin="0"
                                                        Padding="8,6">
                                                        <Grid ColumnSpacing="8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="Auto" />
                                                            </Grid.ColumnDefinitions>
                                                            <StackPanel Spacing="2">
                                                                <TextBlock
                                                                    FontFamily="Cascadia Mono"
                                                                    FontSize="12"
                                                                    Text="{Binding DisplayName}"
                                                                    TextTrimming="CharacterEllipsis" />
                                                                <TextBlock
                                                                    FontSize="11"
                                                                    Opacity="0.75"
                                                                    Text="{Binding DirectoryPath}"
                                                                    TextTrimming="CharacterEllipsis" />
                                                                <TextBlock
                                                                    FontSize="10"
                                                                    Opacity="0.6"
                                                                    Text="{Binding LastOpenedLabel}" />
                                                            </StackPanel>
                                                            <Button
                                                                Grid.Column="1"
                                                                Click="OnPluginSwitcherPinClicked"
                                                                MinWidth="34"
                                                                Style="{StaticResource SubtleAction}"
                                                                ToolTipService.ToolTip="{Binding DataContext.Ui.PluginSwitcherPinTooltip, ElementName=RootPage}">
                                                                <FontIcon
                                                                    FontFamily="Segoe Fluent Icons"
                                                                    Glyph="{Binding PinGlyph}" />
                                                            </Button>
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                        <StackPanel
                                            Orientation="Horizontal"
                                            Spacing="8">
                                            <Button
                                                Click="OnOpenPluginFromDropdownClicked"
                                                Content="{x:Bind ViewModel.Ui.PluginSwitcherOpenButtonContent, Mode=OneWay}"
                                                Style="{StaticResource PrimaryAction}" />
                                            <Button
                                                Command="{Binding SaveWorkspaceCommand}"
                                                Content="{x:Bind ViewModel.Ui.PluginSwitcherSaveButtonContent, Mode=OneWay}"
                                                Style="{StaticResource SubtleAction}" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </Flyout>
                        </DropDownButton.Flyout>
                    </DropDownButton>
                </Grid>
            </Grid>
        </Border>

        <Grid
            Grid.Row="1"
            ColumnSpacing="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <Border
                Grid.Column="0"
                Style="{StaticResource MetricPanelBorderStyle}">
                <StackPanel>
                    <TextBlock
                        Style="{StaticResource MetricLabelTextStyle}"
                        Text="{x:Bind ViewModel.Ui.MetricsTotalRowsLabelText, Mode=OneWay}" />
                    <TextBlock
                        Style="{StaticResource MetricValueTextStyle}"
                        Text="{Binding TotalEntries}" />
                </StackPanel>
            </Border>

            <Border
                Grid.Column="1"
                Style="{StaticResource MetricPanelBorderStyle}">
                <StackPanel>
                    <TextBlock
                        Style="{StaticResource MetricLabelTextStyle}"
                        Text="{x:Bind ViewModel.Ui.MetricsTranslatedLabelText, Mode=OneWay}" />
                    <TextBlock
                        Style="{StaticResource MetricValueTextStyle}"
                        Text="{Binding TranslatedEntries}" />
                </StackPanel>
            </Border>

            <Border
                Grid.Column="2"
                Style="{StaticResource MetricPanelBorderStyle}">
                <StackPanel>
                    <TextBlock
                        Style="{StaticResource MetricLabelTextStyle}"
                        Text="{x:Bind ViewModel.Ui.MetricsPendingLabelText, Mode=OneWay}" />
                    <TextBlock
                        Style="{StaticResource MetricValueTextStyle}"
                        Text="{Binding PendingEntries}" />
                </StackPanel>
            </Border>

            <Border
                Grid.Column="3"
                Style="{StaticResource MetricPanelBorderStyle}">
                <StackPanel>
                    <TextBlock
                        Style="{StaticResource MetricLabelTextStyle}"
                        Text="{x:Bind ViewModel.Ui.MetricsCompletionLabelText, Mode=OneWay}" />
                    <TextBlock
                        Style="{StaticResource MetricValueTextStyle}"
                        Text="{Binding CompletionPercent}" />
                </StackPanel>
            </Border>
        </Grid>

        <Grid
            Grid.Row="2"
            ColumnSpacing="10"
            RowSpacing="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="7*" />
                <ColumnDefinition Width="3*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <Border
                Grid.Row="0"
                Grid.Column="0"
                Style="{StaticResource MainPanelBorderStyle}">
                <Grid RowSpacing="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Grid ColumnSpacing="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2.3*" />
                            <ColumnDefinition Width="1*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="1.2*" />
                        </Grid.ColumnDefinitions>
                        <TextBox
                            x:Name="SearchTextBox"
                            Grid.Column="0"
                            Style="{StaticResource UnifiedInputTextBoxStyle}"
                            Header="{x:Bind ViewModel.Ui.MainSearchBoxHeader, Mode=OneWay}"
                            KeyDown="OnSearchTextBoxKeyDown"
                            PlaceholderText="{x:Bind ViewModel.Ui.MainSearchBoxPlaceholderText, Mode=OneWay}"
                            TabIndex="0"
                            Text="{Binding SearchText, Mode=TwoWay}" />
                        <ComboBox
                            Grid.Column="1"
                            Style="{StaticResource UnifiedInputComboBoxStyle}"
                            Header="{x:Bind ViewModel.Ui.MainListFilterBoxHeader, Mode=OneWay}"
                            DisplayMemberPath="DisplayName"
                            ItemsSource="{Binding ListFilterOptions}"
                            SelectedValue="{Binding SelectedListFilter, Mode=TwoWay}"
                            SelectedValuePath="Value"
                            TabIndex="1" />
                        <ToggleSwitch
                            Grid.Column="2"
                            Header="{x:Bind ViewModel.Ui.MainOnlyPendingToggleHeader, Mode=OneWay}"
                            IsOn="{Binding ShowUntranslatedOnly, Mode=TwoWay}"
                            TabIndex="2" />
                        <ToggleSwitch
                            Grid.Column="3"
                            Header="{x:Bind ViewModel.Ui.MainIncludeLockedToggleHeader, Mode=OneWay}"
                            IsOn="{Binding ShowLocked, Mode=TwoWay}"
                            TabIndex="3" />
                        <StackPanel
                            Grid.Column="4"
                            Spacing="4">
                            <TextBlock
                                Style="{StaticResource MetricLabelTextStyle}"
                                Text="{x:Bind ViewModel.Ui.AiCopilotProviderChainHeaderText, Mode=OneWay}" />
                            <ComboBox
                                x:Name="ModelSelectorComboBox"
                                Style="{StaticResource UnifiedInputComboBoxStyle}"
                                ItemsSource="{Binding ProviderOptions}"
                                SelectedItem="{Binding SelectedProviderOption, Mode=TwoWay}"
                                TabIndex="4">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate x:DataType="viewModels:ProviderChainItemViewModel">
                                        <TextBlock
                                            FontFamily="Cascadia Mono"
                                            Text="{Binding DisplayText}"
                                            TextTrimming="CharacterEllipsis" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>
                    </Grid>

                    <Border
                        Grid.Row="1"
                        Style="{StaticResource InsetPanelBorderStyle}">
                        <Grid ColumnSpacing="8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2.4*" />
                                <ColumnDefinition Width="1.2*" />
                                <ColumnDefinition Width="2.6*" />
                                <ColumnDefinition Width="2.6*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Grid.Column="0"
                                Style="{StaticResource DenseHeaderTextStyle}"
                                Text="{x:Bind ViewModel.Ui.MainTableHeaderEdidText, Mode=OneWay}" />
                            <TextBlock
                                Grid.Column="1"
                                Style="{StaticResource DenseHeaderTextStyle}"
                                Text="{x:Bind ViewModel.Ui.MainTableHeaderFieldText, Mode=OneWay}" />
                            <TextBlock
                                Grid.Column="2"
                                Style="{StaticResource DenseHeaderTextStyle}"
                                Text="{x:Bind ViewModel.Ui.MainTableHeaderSourceText, Mode=OneWay}" />
                            <TextBlock
                                Grid.Column="3"
                                Style="{StaticResource DenseHeaderTextStyle}"
                                Text="{x:Bind ViewModel.Ui.MainTableHeaderTranslationText, Mode=OneWay}" />
                        </Grid>
                    </Border>

                    <ListView
                        x:Name="RowsListView"
                        Grid.Row="2"
                        ItemContainerStyle="{StaticResource InteractiveListItemStyle}"
                        Background="{StaticResource MainSurfaceAltBrush}"
                        BorderBrush="{StaticResource MainPanelBorderBrush}"
                        BorderThickness="1"
                        Padding="0"
                        KeyDown="OnRowsListViewKeyDown"
                        ItemsSource="{Binding Rows}"
                        SelectedItem="{Binding SelectedRow, Mode=TwoWay}"
                        SelectionMode="Single"
                        TabIndex="5">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewModels:TranslationRowViewModel">
                                <Border
                                    Background="Transparent"
                                    BorderBrush="{StaticResource VsCodeBorderBrush}"
                                    BorderThickness="0,0,0,1"
                                    CornerRadius="0"
                                    Margin="0"
                                    Padding="8,6">
                                    <Grid ColumnSpacing="8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="4" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Border
                                            Background="{Binding StatusBrush}"
                                            CornerRadius="0" />
                                        <Grid
                                            Grid.Column="1"
                                            ColumnSpacing="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="2.4*" />
                                                <ColumnDefinition Width="1.2*" />
                                                <ColumnDefinition Width="2.6*" />
                                                <ColumnDefinition Width="2.6*" />
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0">
                                                <TextBlock
                                                    FontFamily="Cascadia Mono"
                                                    FontSize="12"
                                                    Text="{Binding EditorId}" />
                                                <StackPanel
                                                    Orientation="Horizontal"
                                                    Spacing="6">
                                                    <TextBlock
                                                        FontSize="11"
                                                        Opacity="0.65"
                                                        Text="{Binding ListKind}" />
                                                    <TextBlock
                                                        FontSize="11"
                                                        Foreground="{Binding StatusBrush}"
                                                        Text="{Binding QualityLabel}" />
                                                </StackPanel>
                                            </StackPanel>
                                            <TextBlock
                                                Grid.Column="1"
                                                FontFamily="Cascadia Mono"
                                                FontSize="12"
                                                Opacity="0.85"
                                                Text="{Binding FieldSignature}" />
                                            <TextBlock
                                                Grid.Column="2"
                                                FontSize="12"
                                                Text="{Binding SourceText}"
                                                TextTrimming="CharacterEllipsis" />
                                            <TextBlock
                                                Grid.Column="3"
                                                FontSize="12"
                                                Text="{Binding TranslatedText}"
                                                TextTrimming="CharacterEllipsis" />
                                        </Grid>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>
            </Border>

            <Border
                x:Name="AiDrawerBorder"
                Grid.Row="1"
                Grid.Column="0"
                Grid.ColumnSpan="2"
                Style="{StaticResource MainPanelBorderStyle}">
                <Grid RowSpacing="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <Grid ColumnSpacing="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <StackPanel
                            Orientation="Horizontal"
                            Spacing="8">
                            <TextBlock
                                Style="{StaticResource SectionTitleTextStyle}"
                                Text="{x:Bind ViewModel.Ui.AiCopilotSectionTitleText, Mode=OneWay}" />
                            <TextBlock
                                Style="{StaticResource MetricLabelTextStyle}"
                                Text="{x:Bind ViewModel.Ui.AiCopilotMcpHintText, Mode=OneWay}"
                                TextTrimming="CharacterEllipsis" />
                        </StackPanel>
                        <StackPanel
                            Grid.Column="1"
                            Orientation="Horizontal"
                            Spacing="6">
                            <Button
                                Click="OnOpenAiProviderSetupPageClicked"
                                Content="{x:Bind ViewModel.Ui.MenuConfiguration, Mode=OneWay}"
                                Style="{StaticResource SubtleAction}"
                                TabIndex="12" />
                            <Button
                                x:Name="AiDrawerToggleButton"
                                Click="OnAiDrawerToggleClicked"
                                Style="{StaticResource SubtleAction}"
                                TabIndex="13" />
                        </StackPanel>
                    </Grid>

                    <Grid
                        x:Name="AiDrawerContentGrid"
                        Grid.Row="1"
                        Height="{Binding AiDrawerHeight, Mode=TwoWay}"
                        RowSpacing="8"
                        Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <Border
                            x:Name="AiDrawerResizeHandle"
                            Background="Transparent"
                            CornerRadius="0"
                            Padding="0,0,0,2"
                            PointerCaptureLost="OnAiDrawerResizeHandlePointerCaptureLost"
                            PointerMoved="OnAiDrawerResizeHandlePointerMoved"
                            PointerPressed="OnAiDrawerResizeHandlePointerPressed"
                            PointerReleased="OnAiDrawerResizeHandlePointerReleased">
                            <Border
                                Width="88"
                                Height="4"
                                CornerRadius="2"
                                Background="{StaticResource VsCodeBorderBrush}"
                                HorizontalAlignment="Center" />
                        </Border>

                        <ListView
                            x:Name="AiChatMessagesListView"
                            Grid.Row="1"
                            Background="{StaticResource MainSurfaceAltBrush}"
                            BorderBrush="{StaticResource MainPanelBorderBrush}"
                            BorderThickness="1"
                            IsItemClickEnabled="False"
                            ItemsSource="{Binding AiChatMessages}"
                            MaxHeight="340"
                            MinHeight="220"
                            SelectionMode="None"
                            IsTabStop="False">
                            <ListView.ItemTemplate>
                                <DataTemplate x:DataType="viewModels:AiChatMessageViewModel">
                                    <StackPanel Margin="0,0,0,8">
                                        <StackPanel
                                            HorizontalAlignment="{Binding BubbleAlignment}"
                                            Orientation="Horizontal"
                                            Spacing="8">
                                            <TextBlock
                                                Style="{StaticResource MetricLabelTextStyle}"
                                                Text="{Binding RoleDisplayName}" />
                                            <TextBlock
                                                Style="{StaticResource MetricLabelTextStyle}"
                                                Text="{Binding TimestampText}" />
                                        </StackPanel>
                                        <Border
                                            HorizontalAlignment="{Binding BubbleAlignment}"
                                            MaxWidth="840"
                                            Background="{Binding BubbleBrush}"
                                            BorderBrush="{StaticResource MainPanelBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Padding="10">
                                            <TextBlock
                                                FontSize="12"
                                                Text="{Binding MessageText}"
                                                TextWrapping="WrapWholeWords" />
                                        </Border>
                                    </StackPanel>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>

                        <Grid
                            Grid.Row="2"
                            ColumnSpacing="8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel
                                Grid.Column="0"
                                Spacing="4">
                                <TextBox
                                    x:Name="AiChatInputTextBox"
                                    Style="{StaticResource UnifiedInputTextBoxStyle}"
                                    AcceptsReturn="True"
                                    KeyDown="OnAiChatInputKeyDown"
                                    MaxHeight="180"
                                    MinHeight="88"
                                    PlaceholderText="{x:Bind ViewModel.Ui.AiCopilotInputBoxPlaceholderText, Mode=OneWay}"
                                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                                    TabIndex="14"
                                    Text="{Binding AiChatInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                <StackPanel
                                    Orientation="Horizontal"
                                    Spacing="6">
                                    <ProgressRing
                                        Height="14"
                                        IsActive="{Binding IsAiChatBusy}"
                                        Width="14" />
                                    <TextBlock
                                        Style="{StaticResource MetricLabelTextStyle}"
                                        Text="{x:Bind ViewModel.Ui.AiCopilotBusyText, Mode=OneWay}" />
                                </StackPanel>
                            </StackPanel>
                            <Button
                                Grid.Column="1"
                                VerticalAlignment="Bottom"
                                Command="{Binding SendAiChatMessageCommand}"
                                Content="{x:Bind ViewModel.Ui.AiCopilotSendButtonContent, Mode=OneWay}"
                                TabIndex="15"
                                Style="{StaticResource PrimaryAction}" />
                            <Button
                                Grid.Column="2"
                                VerticalAlignment="Bottom"
                                Command="{Binding ClearAiChatHistoryCommand}"
                                Content="{x:Bind ViewModel.Ui.AiCopilotClearButtonContent, Mode=OneWay}"
                                TabIndex="16"
                                Style="{StaticResource SubtleAction}" />
                        </Grid>
                    </Grid>
                </Grid>
            </Border>
            <Border
                Grid.Row="0"
                Grid.Column="1"
                Style="{StaticResource MainPanelBorderStyle}">
                <Grid RowSpacing="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock
                        Style="{StaticResource SectionTitleTextStyle}"
                        Text="{x:Bind ViewModel.Ui.InspectorSectionTitleText, Mode=OneWay}" />

                    <StackPanel
                        Grid.Row="1"
                        Spacing="6">
                        <Grid ColumnSpacing="8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <StackPanel>
                                <TextBlock
                                    Style="{StaticResource MetricLabelTextStyle}"
                                    Text="{x:Bind ViewModel.Ui.InspectorEdidLabelText, Mode=OneWay}" />
                                <TextBlock
                                    FontFamily="Cascadia Mono"
                                    Text="{Binding InspectorRecordId}"
                                    TextWrapping="WrapWholeWords" />
                            </StackPanel>
                            <StackPanel Grid.Column="1">
                                <TextBlock
                                    Style="{StaticResource MetricLabelTextStyle}"
                                    Text="{x:Bind ViewModel.Ui.InspectorFieldLabelText, Mode=OneWay}" />
                                <TextBlock
                                    FontFamily="Cascadia Mono"
                                    Text="{Binding InspectorField}"
                                    TextWrapping="WrapWholeWords" />
                            </StackPanel>
                        </Grid>
                        <TextBlock
                            Style="{StaticResource MetricLabelTextStyle}"
                            Text="{Binding InspectorHint}"
                            TextWrapping="WrapWholeWords" />
                    </StackPanel>

                    <TextBox
                        Grid.Row="2"
                        Style="{StaticResource UnifiedInputTextBoxStyle}"
                        AcceptsReturn="True"
                        Header="{x:Bind ViewModel.Ui.InspectorSourceBoxHeader, Mode=OneWay}"
                        IsReadOnly="True"
                        MinHeight="120"
                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                        Text="{Binding InspectorSourceText}" />

                    <TextBox
                        x:Name="InspectorTranslationTextBox"
                        Grid.Row="3"
                        Style="{StaticResource UnifiedInputTextBoxStyle}"
                        AcceptsReturn="True"
                        Header="{x:Bind ViewModel.Ui.InspectorTranslationBoxHeader, Mode=OneWay}"
                        KeyDown="OnInspectorTranslationTextBoxKeyDown"
                        MinHeight="120"
                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                        TabIndex="6"
                        Text="{Binding InspectorTranslatedText, Mode=TwoWay}" />

                    <Grid
                        Grid.Row="4"
                        RowSpacing="6">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <StackPanel
                            Orientation="Horizontal"
                            Spacing="6">
                            <Button
                                Command="{Binding ApplyInspectorToRowCommand}"
                                Content="{x:Bind ViewModel.Ui.InspectorApplyButtonContent, Mode=OneWay}"
                                TabIndex="7"
                                Style="{StaticResource PrimaryAction}" />
                            <Button
                                Command="{Binding CopySourceToTargetCommand}"
                                Content="{x:Bind ViewModel.Ui.InspectorCopySourceButtonContent, Mode=OneWay}"
                                TabIndex="8"
                                Style="{StaticResource SubtleAction}" />
                            <Button
                                Command="{Binding MarkSelectedValidatedCommand}"
                                Content="{x:Bind ViewModel.Ui.InspectorMarkValidatedButtonContent, Mode=OneWay}"
                                TabIndex="9"
                                Style="{StaticResource SecondaryAction}" />
                        </StackPanel>
                        <StackPanel
                            Grid.Row="1"
                            Orientation="Horizontal"
                            Spacing="6">
                            <Button
                                Command="{Binding ToggleSelectedLockCommand}"
                                Content="{x:Bind ViewModel.Ui.InspectorToggleLockButtonContent, Mode=OneWay}"
                                TabIndex="10"
                                Style="{StaticResource SubtleAction}" />
                            <Button
                                Command="{Binding AddScopedDictionaryEntryFromSelectedRowCommand}"
                                Content="{x:Bind ViewModel.Ui.InspectorAddToDictionaryButtonContent, Mode=OneWay}"
                                TabIndex="11"
                                Style="{StaticResource SecondaryAction}" />
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
        </Grid>


        <Border
            Grid.Row="3"
            Style="{StaticResource FluentSurfaceBorderStyle}"
            Background="{StaticResource MainSurfaceBrush}"
            Padding="12,8">
            <Grid ColumnSpacing="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock
                    VerticalAlignment="Center"
                    Text="{Binding StatusText}" />
                <StackPanel
                    Grid.Column="1"
                    HorizontalAlignment="Stretch"
                    Spacing="4">
                    <TextBlock
                        FontSize="11"
                        Foreground="{StaticResource VsCodeSubtleTextBrush}"
                        Text="{Binding KeyboardShortcutHint}"
                        TextAlignment="Right"
                        TextTrimming="CharacterEllipsis" />
                    <ProgressBar
                        Maximum="100"
                        Minimum="0"
                        Value="{Binding CompletionPercent}" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>









